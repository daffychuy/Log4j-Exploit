> **Warning**: This Repository is only for educational purposes.

# Index
- [Introduction](#introduction)
- [Prerequisites](#prerequisites)
  - [Need help installing?](#need-help-installing)
- [Setting up the environment](#setup-the-environment)
  - [Java Setup](#java-setup)
  - [Maven Setup](#maven-setup)
- [Assignment Instructions](#assignment-instructions)
  - [Assignment Setup](#assignment-setup)
    - [Setting up the VM](#setting-up-the-vm)
  - [Assignment Questions](#assignment-questions)
  - [FAQ](#assignment-faq)
- [References](#references)
  


# Introduction
Welcome to the Log4j Assignment for PRA9201. 


# Prerequesites 
- [Java](https://www.oracle.com/technetwork/java/javase/downloads/index.html) (https://www.oracle.com/technetwork/java/javase/downloads/index.html)
- [Maven](https://maven.apache.org/download.cgi) (https://maven.apache.org/download.cgi)
- [VMWare Image Containing SprintBoot Server](https://drive.google.com/file/d/1-7jJ5cSVIXK8bCUSmtGHY09049AkEQ91/view?usp=sharing) 
  - Google Drive: https://drive.google.com/file/d/1-7jJ5cSVIXK8bCUSmtGHY09049AkEQ91/view?usp=sharing
  - UofT SharePoint: 

### Need help installing? 
- Refer to [Setup the environment](#setup-the-environment) section

# Setup the environment
Note: The following instruction is for **debian** based system only.

## Java Setup
```bash
sudo apt update
sudo apt install default-jre
```

## Maven Setup 
```bash
sudo apt update
sudo apt install maven
```


# Assignment Instructions

# Assignment Setup
## Setting up the VM
Download the VM found in [prerequisite](#prerequisites) section, and open existing vm using VMWare or any other software.
> Note: This is only for x86_64 architecture, so not compatible for any Arm devices. For poeple working on ARM devices, please refer to Piazza on how to ssh into the lab machine or work on it in the lab rooms.

Since we do require the use of Host IP address for the LDAP server, you must set your Network Adapter to either NAT or Bridge (It is default to NAT).

Example:
![Network Adapter](Network-Adapter.jpg)

Finally, after you get the server started, the vulnerable SpringBoot server should start automatically. To test this, do a simple `curl ip:8080` to see if it generate back an output. 
Don't know what your ip is? Refer to: [FAQ](#assignment-faq)

# Assignment Questions
Here's the link to google drive for you to clone and write answers in [link](https://docs.google.com/document/d/1JPHDLloG0hBfsZLEbxcUkJD8Q3e49OUsB0RcvvvmOj0/edit?usp=sharing).
1. How does Log4Shell work? Be sure to mention the roles of the victim’s server, the attacker’s LDAP server, and how the attack is actually carried out.
2. In the earlier versions of log4j, the JNDI lookup was enabled by default. What kind of security concept did this violate?
3. Was JNDI:LDAP the only possible way to perform a RCE attack using Log4j 2? If yes, please explain why. If not, please give an example of another RCE attack using Log4j that does not involve LDAP.
4. Using the LDAP server given from the lab, create and execute an exploit such that you gain access to the server via SSH login. (HINT: You need to create a new user, since root login is disabled) Provide the commands you used to execute this.
5. We’ve created a secret file listed under /secrets with the file name secretfile.txt, create another exploit such that you can gain access to content of the folder. (HINT: You must somehow make your own group a root group or as a sudoer, since this folder has a permission of 750) Finally, provide the commands you used to execute this and paste the content of the file as the answer.

# Assignment FAQ
1. How do I find the ip address of the vm if I can't login to any of the user?
    - Make sure you first set your network adatpter to either NAT or Bridge such that you can connect to this VM.
    - When you start up the vm, you should see a login screen that asks for your username and password (Like any of Ubuntu default's login), but along that page, we added a "Your IP" section, that will display your IP address that you can use for the VM. 
    
    ![Your IP](my-ip.jpg)
2. How do I run the exploit?
    - Please refer to the lab instruction [here](https://github.com/daffychuy/Log4j-Exploit)

# References
- [StandB/CVE-2021-44228-poc](https://github.com/StandB/CVE-2021-44228-poc#readme)
- [Veracode-research/rogue-jndi](https://github.com/veracode-research/rogue-jndi)